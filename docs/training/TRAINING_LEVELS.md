# 漸進式訓練策略

**目的**: 不是每次都跑35小時！用小規模快速迭代，只在最後跑完整訓練。

---

## 📊 訓練層級總覽

| Level | 用途 | 衛星數 | Episodes | 時間 | 覆蓋 |
|-------|------|--------|---------|------|------|
| **Level 0** | 系統驗證 | 10 | 10 | 10分鐘 | 0.7天 |
| **Level 1** | 訓練邏輯 | 20 | 100 | 2小時 | 6.6天 |
| **Level 2** | 開發調試 | 50 | 300 | 6小時 | 19.8天 |
| **Level 3** | 驗證效果 | 101 | 500 | 10小時 | 16.5天 |
| **Level 4** | 建立基準 | 101 | 1000 | 21小時 | 33天 |
| **Level 5** | 完整訓練 | 101 | 1700 | 35小時 | 56天 |

---

## 🎯 各層級詳細說明

### Level 0: Smoke Test (10分鐘)

**目的**: 驗證代碼能正常運行

```bash
python3 train_online_rl.py \
    --num-satellites 10 \
    --num-episodes 10 \
    --output-dir output/level0_smoke_test \
    --log-interval 5
```

**預期**:
- ✅ 代碼無錯誤
- ✅ 環境、Agent 正常初始化
- ✅ Episode 能完成
- ❌ 不期待學習效果

**適用場景**:
- 修改代碼後快速驗證
- 部署到新機器
- Debug 基本問題

---

### Level 1: Quick Test (2小時)

**目的**: 驗證訓練邏輯、觀察學習曲線

```bash
python3 train_online_rl.py \
    --num-satellites 20 \
    --num-episodes 100 \
    --output-dir output/level1_quick_test \
    --log-interval 10
```

**預期**:
- ✅ Reward 有上升趨勢
- ✅ Epsilon decay 正常
- ✅ Loss 曲線合理
- ⚠️ 可能未收斂

**適用場景**:
- 驗證獎勵函數設計
- 測試新的訓練策略
- 快速驗證想法

---

### Level 2: Development (6小時)

**目的**: 開發時調試超參數、獎勵函數

```bash
python3 train_online_rl.py \
    --num-satellites 50 \
    --num-episodes 300 \
    --output-dir output/level2_development \
    --log-interval 20 \
    --checkpoint-interval 100
```

**預期**:
- ✅ 學習曲線開始收斂
- ✅ 可以比較不同超參數
- ✅ 足夠的軌道多樣性 (~300個軌道)
- ⚠️ 衛星數較少，換手場景有限

**適用場景**:
- 調整學習率、gamma、epsilon
- 測試不同獎勵權重
- 對比不同網絡架構

---

### Level 3: Validation (10小時) ⭐ 推薦開始

**目的**: 驗證訓練效果，基準對比

```bash
python3 train_online_rl.py \
    --num-episodes 500 \
    --output-dir output/level3_validation \
    --log-interval 50 \
    --checkpoint-interval 100
```

**配置**:
- 衛星數: 101 (完整 Starlink)
- Episodes: 500
- Overlap: 50%
- 覆蓋: 16.5天 (~250個不同軌道)

**預期**:
- ✅ 基本收斂
- ✅ 可與3GPP A3 baseline 比較
- ✅ 可發現明顯問題
- ✅ **足夠用於論文初稿**

**適用場景**:
- 驗證RL比傳統方法好
- 建立初步實驗結果
- 論文初稿實驗

---

### Level 4: Baseline (21小時)

**目的**: 建立穩定的基準線

```bash
python3 train_online_rl.py \
    --num-episodes 1000 \
    --output-dir output/level4_baseline \
    --log-interval 50 \
    --checkpoint-interval 200
```

**配置**:
- 衛星數: 101
- Episodes: 1000
- Overlap: 50%
- 覆蓋: 33天 (~500個不同軌道)

**預期**:
- ✅ 完全收斂
- ✅ 結果穩定可靠
- ✅ 可用於論文實驗

**適用場景**:
- 建立可重複的基準
- 對比實驗（不同算法、配置）
- 論文實驗（如果時間有限）

---

### Level 5: Full Training (35小時)

**目的**: 完整訓練，與論文規模一致

```bash
python3 train_online_rl.py \
    --num-episodes 1700 \
    --output-dir output/level5_full_training \
    --log-interval 100 \
    --checkpoint-interval 500
```

**配置**:
- 衛星數: 101
- Episodes: 1700 (論文規模)
- Overlap: 50%
- 覆蓋: 56天 (~850個不同軌道)

**預期**:
- ✅ 最佳性能
- ✅ 最穩定收斂
- ✅ 論文最終實驗

**適用場景**:
- 論文最終實驗
- 與其他論文對比
- 發表前的完整訓練

---

## 🚀 推薦工作流程

### Week 1: 快速迭代

```
Day 1 上午: Level 0 (10分鐘) → 驗證系統
Day 1 下午: Level 1 (2小時) → 看到學習曲線
Day 2:     Level 2 (6小時) → 調整超參數
Day 3:     Level 3 (10小時) → 驗證收斂
```

**在這4天內**，你已經：
- ✅ 驗證了系統正常運作
- ✅ 看到了學習效果
- ✅ 調整了超參數
- ✅ 得到了可用的初步結果

**總時間**: <20小時

### Week 2-3: 完整實驗（可選）

```
Week 2: Level 4 (21小時) → 如果需要更穩定的結果
Week 3: Level 5 (35小時) → 論文最終實驗（投稿前）
```

---

## 🔧 參數調整指南

### 控制訓練時間的參數（按影響大小排序）

1. **Episodes** (最直接)
   - 減半 → 訓練時間減半
   - 推薦: 100 → 300 → 500 → 1000 → 1700

2. **衛星數**
   - 減少 → 略微加快（每episode計算量減少）
   - 推薦: 10 → 20 → 50 → 101

3. **Overlap** (影響時間覆蓋，不影響訓練時間)
   - 0% → 覆蓋時間長，多樣性高
   - 50% → 覆蓋時間短，數據密集

4. **Episode Duration** (不建議調整)
   - 固定95分鐘（科學要求）

### 多樣性來源

1. **時間多樣性** (由覆蓋範圍決定)
   - 3天: 極小（僅測試）
   - 7天: 小（開發）
   - 14天: 中（驗證）
   - 30天+: 大（完整訓練）

2. **空間多樣性** (由衛星數決定)
   - 10顆: 低（僅測試）
   - 20-50顆: 中（開發）
   - 101顆: 高（完整訓練）

3. **信號多樣性** (由Episodes決定)
   - 自然涵蓋在時間+空間多樣性中

---

## 💡 關鍵洞察

### ✅ 不需要每次都跑完整訓練

- **開發階段**: Level 1-2 (2-6小時) 足夠
- **驗證階段**: Level 3 (10小時) 已可發現問題
- **論文初稿**: Level 3-4 (10-21小時) 可用
- **最終投稿**: Level 5 (35小時) 最佳

### ✅ 衛星數量不是固定的

- **101顆** = 完整實驗
- **50顆** = 開發調試（50%衛星，80%效果）
- **20顆** = 快速驗證（20%衛星，60%效果）
- **10顆** = 系統測試（僅驗證運行）

### ✅ 時間覆蓋可以調整

- **連續時間採樣**（我們的設計）
- **不需要涵蓋完整288天重複週期**
- **33天 (~500軌道) 已足夠完整訓練**
- **開發時用3-7天即可**

---

## 📈 預期效果對比

| Level | Reward 提升 | 穩定性 | 發表可用 |
|-------|------------|--------|---------|
| Level 0 | ❌ | ❌ | ❌ |
| Level 1 | ⚠️ 初步 | ❌ | ❌ |
| Level 2 | ⚠️ 部分 | ⚠️ | ❌ |
| Level 3 | ✅ 明顯 | ✅ | ⚠️ 初稿 |
| Level 4 | ✅ 完全 | ✅ | ✅ 可用 |
| Level 5 | ✅ 最佳 | ✅ | ✅ 最佳 |

---

## 🎯 TL;DR

**快速驗證想法**: Level 1-2 (2-6小時)
**論文初稿實驗**: Level 3 (10小時)
**論文最終實驗**: Level 4-5 (21-35小時)

**不要一開始就跑Level 5！**

---

**Date**: 2025-10-19
**Author**: Claude Code
